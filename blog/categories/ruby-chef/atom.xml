<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: ruby,chef | jtimberman's Code Blog]]></title>
  <link href="http://jtimberman.housepub.org/blog/categories/ruby-chef/atom.xml" rel="self"/>
  <link href="http://jtimberman.housepub.org/"/>
  <updated>2014-01-16T23:17:48-07:00</updated>
  <id>http://jtimberman.housepub.org/</id>
  <author>
    <name><![CDATA[Joshua Timberman]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Chef and Net::SSH Dependency Broken]]></title>
    <link href="http://jtimberman.housepub.org/blog/2013/02/06/chef-and-net-ssh-dependency-broken/"/>
    <updated>2013-02-06T10:34:00-07:00</updated>
    <id>http://jtimberman.housepub.org/blog/2013/02/06/chef-and-net-ssh-dependency-broken</id>
    <content type="html"><![CDATA[<p><strong>2nd UPDATE</strong>
<a href="http://tickets.opscode.com/browse/CHEF-3835">CHEF-3835</a> was opened by
a member of the community; Chef versions 11.2.0 and 10.20.0 have been
released by Opscode to resolve the issue.</p>

<p><strong>UPDATE</strong> Opscode is working on getting a new release of the Chef gem
  with updated version constraints.</p>

<h1>What Happened?</h1>

<p>Earlier today (February 6, 2013), a new version of the various net-ssh
RubyGems were published. This includes:</p>

<ul>
<li>net-ssh 2.6.4</li>
<li>net-ssh-multi 1.1.1</li>
<li>net-ssh-gateway 1.1.1</li>
</ul>


<p>Chef&rsquo;s dependencies have a pessimistic version constraint (<code>~&gt;</code>) on
net-ssh 2.2.2.</p>

<h1>What&rsquo;s the Problem?</h1>

<p>So what is the problem?</p>

<p>It appears to lie with net-ssh-gateway. The version of net-ssh-gateway
went from 1.1.0 (released in April 2011), to 1.1.1. It depends on
net-ssh. In net-ssh-gateway 1.1.0, the net-ssh version constraint was
<code>&gt;= 1.99.1</code>, which is fine with Chef&rsquo;s constraint against <code>~&gt; 2.2.2</code>.
However, in net-ssh-gateway 1.1.1, the net-ssh version constraint was
changed to <code>&gt;= 2.6.4</code>, which is obviously a conflict with Chef&rsquo;s
constraint.</p>

<h1>What&rsquo;s the Solution?</h1>

<p>So, how can we fix it?</p>

<p>One solution is to use the Opscode Omnibus Package for Chef. This
isn&rsquo;t a solution for everyone, of course, but it does include and
contain all the dependencies. This also doesn&rsquo;t help if one wishes to
install another gem that depends on Chef under the &ldquo;Omnibus&rdquo; Ruby
environment along with Chef, because the conflict will be found. For
example, to use the minitest-chef-handler gem for running
minitest-chef tests.</p>

<p><code>vagrant@ubuntu-12-04:~$ /opt/chef/embedded/bin/gem install
minitest-chef-handler ERROR: While executing gem ...
(Gem::DependencyError) Unable to resolve dependencies: net-ssh-gateway
requires net-ssh (&gt;= 2.6.4)</code></p>

<p>Another solution is to relax / modify the constraint in Chef. This may
be okay, but as of <em>right now</em> we don&rsquo;t know if this will affect
anything in the way that Chef uses net-ssh. We have tickets related to
net-ssh version constraints in Chef:</p>

<ul>
<li><a href="http://tickets.opscode.com/browse/CHEF-2977">http://tickets.opscode.com/browse/CHEF-2977</a></li>
<li><a href="http://tickets.opscode.com/browse/CHEF-3156">http://tickets.opscode.com/browse/CHEF-3156</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
